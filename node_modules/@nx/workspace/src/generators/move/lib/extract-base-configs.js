"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.maybeExtractEslintConfigIfRootProject = exports.maybeExtractJestConfigBase = exports.maybeExtractTsConfigBase = void 0;
const tslib_1 = require("tslib");
const devkit_1 = require("@nx/devkit");
function maybeExtractTsConfigBase(tree) {
    let extractTsConfigBase;
    try {
        extractTsConfigBase = require('@nx/' + 'js').extractTsConfigBase;
    }
    catch (_a) {
        // Not installed, skip
        return;
    }
    extractTsConfigBase(tree);
}
exports.maybeExtractTsConfigBase = maybeExtractTsConfigBase;
function maybeExtractJestConfigBase(tree) {
    return tslib_1.__awaiter(this, void 0, void 0, function* () {
        let jestInitGenerator;
        try {
            jestInitGenerator = require('@nx/' + 'jest').jestInitGenerator;
        }
        catch (_a) {
            // Not installed, skip
            return;
        }
        yield jestInitGenerator(tree, {});
    });
}
exports.maybeExtractJestConfigBase = maybeExtractJestConfigBase;
function maybeExtractEslintConfigIfRootProject(tree, rootProject) {
    if (rootProject.root !== '.')
        return;
    if (tree.exists('.eslintrc.base.json'))
        return;
    let migrateConfigToMonorepoStyle;
    try {
        migrateConfigToMonorepoStyle = require('@nx/' +
            'linter/src/generators/init/init-migration').migrateConfigToMonorepoStyle;
    }
    catch (_a) {
        // linter not install
    }
    // Only need to handle migrating the root rootProject.
    // If other libs/apps exist, then this migration is already done by `@nx/linter:lint-rootProject` generator.
    migrateConfigToMonorepoStyle === null || migrateConfigToMonorepoStyle === void 0 ? void 0 : migrateConfigToMonorepoStyle([rootProject.name], tree, tree.exists((0, devkit_1.joinPathFragments)(rootProject.root, 'jest.config.ts')) ||
        tree.exists((0, devkit_1.joinPathFragments)(rootProject.root, 'jest.config.js'))
        ? 'jest'
        : 'none');
}
exports.maybeExtractEslintConfigIfRootProject = maybeExtractEslintConfigIfRootProject;
